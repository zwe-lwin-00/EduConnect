<div class="auth-wrapper">
  <div class="auth-bg"></div>
  <div class="auth-content">
    <p-card styleClass="auth-card">
      <div class="auth-header">
        <span class="auth-logo"><i class="pi pi-lock"></i></span>
        <h1>Change password</h1>
        <p class="auth-subtitle">Set a new password to continue. You must change it before using the platform.</p>
      </div>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <p-message *ngIf="errorMessage" severity="error" [text]="errorMessage" styleClass="w-full mb-3" />
        <div class="field">
          <label for="currentPassword" class="label-required">Current password <span class="required-asterisk">*</span></label>
          <input pInputText id="currentPassword" type="password" formControlName="currentPassword" class="w-full" placeholder="••••••••"
            [class.p-invalid]="form.get('currentPassword')?.invalid && form.get('currentPassword')?.touched" />
          <small class="p-error" *ngIf="form.get('currentPassword')?.hasError('required') && form.get('currentPassword')?.touched">Current password is required</small>
          <small class="p-error" *ngIf="form.get('currentPassword')?.hasError('minlength') && form.get('currentPassword')?.touched">At least 8 characters</small>
        </div>
        <div class="field">
          <label for="newPassword" class="label-required">New password <span class="required-asterisk">*</span></label>
          <input pInputText id="newPassword" type="password" formControlName="newPassword" class="w-full" placeholder="••••••••"
            [class.p-invalid]="form.get('newPassword')?.invalid && form.get('newPassword')?.touched" />
          <small class="p-error" *ngIf="form.get('newPassword')?.hasError('required') && form.get('newPassword')?.touched">New password is required</small>
          <small class="p-error" *ngIf="form.get('newPassword')?.hasError('minlength') && form.get('newPassword')?.touched">At least 8 characters</small>
        </div>
        <div class="field">
          <label for="confirmNewPassword" class="label-required">Confirm new password <span class="required-asterisk">*</span></label>
          <input pInputText id="confirmNewPassword" type="password" formControlName="confirmNewPassword" class="w-full" placeholder="••••••••"
            [class.p-invalid]="form.get('confirmNewPassword')?.invalid && form.get('confirmNewPassword')?.touched" />
          <small class="p-error" *ngIf="form.get('confirmNewPassword')?.hasError('required') && form.get('confirmNewPassword')?.touched">Please confirm your new password</small>
          <small class="p-error" *ngIf="form.get('confirmNewPassword')?.hasError('confirmPassword') && form.get('confirmNewPassword')?.touched">Passwords do not match</small>
        </div>
        <p-button type="submit" label="{{ isLoading ? 'Updating...' : 'Change password' }}" icon="pi pi-check" [loading]="isLoading" [disabled]="form.invalid || isLoading"
          styleClass="w-full mt-4" />
      </form>
    </p-card>
  </div>
</div>
