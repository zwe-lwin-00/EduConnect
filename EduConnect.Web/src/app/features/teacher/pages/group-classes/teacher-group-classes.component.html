<div class="teacher-group-classes">
  <div class="page-header-compact">
    <div>
      <h1>Group classes</h1>
      <p class="page-desc-short">Edit name, Zoom link, and students. Admin creates and assigns classes to you.</p>
    </div>
  </div>

  <div *ngIf="error" class="error">{{ error }}</div>

  <section class="section list-section">
    <h2 class="section-title">Your classes</h2>
    <div *ngIf="loading" class="loading">Loading...</div>
    <div *ngIf="!loading && groupClasses.length === 0" class="empty">No group classes assigned to you.</div>
    <div *ngIf="!loading && groupClasses.length > 0" class="class-list">
      <div *ngFor="let gc of groupClasses" class="class-card">
        <div class="class-info">
          <strong>{{ gc.name }}</strong>
          <span class="badge" [class.inactive]="!gc.isActive">{{ gc.isActive ? 'Active' : 'Inactive' }}</span>
          <span class="enrolled">Enrolled: {{ gc.enrolledCount }}</span>
        </div>
        <div class="class-actions">
          <button type="button" class="btn btn-secondary" (click)="viewEnrollments(gc)">Enrollments</button>
        </div>
      </div>
    </div>
  </section>

  <div *ngIf="selectedGroupClass" class="modal-overlay" (click)="closeEnrollments()">
    <div class="modal modal-lg" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ selectedGroupClass.name }}</h3>
        <button type="button" class="btn-close" (click)="closeEnrollments()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="edit-section">
          <label>Name</label>
          <input type="text" [(ngModel)]="editName" class="form-control" />
          <label>Zoom link</label>
          <input type="url" [(ngModel)]="editZoomUrl" class="form-control" placeholder="https://zoom.us/j/..." />
          <label class="checkbox-label"><input type="checkbox" [(ngModel)]="editIsActive" /> Active</label>
          <button type="button" class="btn btn-secondary btn-sm" (click)="updateGroupClass()" [disabled]="updating">{{ updating ? 'Saving...' : 'Save' }}</button>
        </div>
        <h4 class="subheading">Students</h4>
        <div class="add-enroll-inline" *ngIf="assignableContracts.length > 0">
          <select [(ngModel)]="selectedEnrollContract" class="form-control inline-select">
            <option [ngValue]="null">Add student...</option>
            <option *ngFor="let s of assignableContracts" [ngValue]="s">{{ s.studentName }} – {{ s.contractIdDisplay }}</option>
          </select>
          <button type="button" class="btn btn-primary" (click)="enroll()" [disabled]="!selectedEnrollContract || enrolling">{{ enrolling ? '...' : 'Add' }}</button>
        </div>
        <ul class="enrollment-list">
          <li *ngFor="let e of enrollments" class="enrollment-item">
            <span>{{ e.studentName }} – {{ e.contractIdDisplay }}</span>
            <button type="button" class="btn btn-sm btn-danger" (click)="unenroll(e.id)">Remove</button>
          </li>
          <li *ngIf="enrollments.length === 0" class="empty">No students yet.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
