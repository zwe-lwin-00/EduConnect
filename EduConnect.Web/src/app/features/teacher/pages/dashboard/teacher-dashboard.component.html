<div class="teacher-dashboard">
  <div class="page-header-compact">
    <div>
      <h1>Dashboard</h1>
      <p class="page-desc-short">Today’s sessions and quick actions</p>
    </div>
    <p-button label="Sessions" icon="pi pi-calendar" routerLink="/teacher/sessions" />
  </div>

  <p-message *ngIf="error" severity="error" [text]="error" styleClass="w-full mb-3" />

  <ng-container *ngIf="loading">
    <div class="dashboard-grid">
      <p-card>
        <p-skeleton width="8rem" height="1.25rem" />
        <p-skeleton width="100%" height="4rem" class="mt-3" />
      </p-card>
      <p-card>
        <p-skeleton width="8rem" height="1.25rem" />
        <p-skeleton width="100%" height="5rem" class="mt-3" />
      </p-card>
      <p-card>
        <p-skeleton width="8rem" height="1.25rem" />
        <p-skeleton width="100%" height="4rem" class="mt-3" />
      </p-card>
      <p-card>
        <p-skeleton width="8rem" height="1.25rem" />
        <p-skeleton width="6rem" height="3rem" class="mt-3" />
      </p-card>
    </div>
  </ng-container>

  <ng-container *ngIf="dashboard && !loading">
    <div class="dashboard-grid">
      <p-card header="Alerts">
        <div *ngIf="dashboard.alerts.length === 0" class="empty-state">No alerts</div>
        <div *ngIf="dashboard.alerts.length > 0" class="alert-list">
          <div *ngFor="let a of dashboard.alerts" class="alert-item">
            <p-tag [value]="a.type" [severity]="alertSeverity(a.type)" styleClass="mr-2" />
            <span class="alert-message">{{ a.message }}</span>
          </div>
        </div>
        <p-button label="Sessions" icon="pi pi-arrow-right" iconPos="right" [link]="true" routerLink="/teacher/sessions" styleClass="p-0 mt-2" />
      </p-card>

      <p-card header="Today">
        <div *ngIf="dashboard.todaySessions.length === 0" class="empty-state">No sessions today</div>
        <div *ngIf="dashboard.todaySessions.length > 0" class="session-list">
          <div *ngFor="let s of dashboard.todaySessions" class="session-item">
            <div class="session-row"><strong>{{ s.studentName }}</strong> – {{ s.contractIdDisplay }}</div>
            <div class="session-meta">{{ s.status }}<span *ngIf="s.checkInTime"> · {{ s.checkInTime | date:'short':'+0630' }}</span></div>
          </div>
        </div>
        <p-button label="Sessions" icon="pi pi-arrow-right" iconPos="right" [link]="true" routerLink="/teacher/sessions" styleClass="p-0 mt-2" />
      </p-card>

      <p-card header="Can start">
        <div *ngIf="dashboard.upcomingSessions.length === 0" class="empty-state">None</div>
        <div *ngIf="dashboard.upcomingSessions.length > 0" class="session-list">
          <div *ngFor="let s of dashboard.upcomingSessions" class="session-item">
            <div class="session-row">{{ s.studentName }} – {{ s.contractIdDisplay }}</div>
          </div>
        </div>
        <p-button label="Sessions" icon="pi pi-arrow-right" iconPos="right" [link]="true" routerLink="/teacher/sessions" styleClass="p-0 mt-2" />
      </p-card>

      <p-card header="Your hours">
        <div class="stat-value">{{ dashboard.totalRemainingHours }}</div>
        <p class="stat-desc">Remaining across contracts</p>
      </p-card>
    </div>
  </ng-container>
</div>
