<div class="admin-parents">
  <div class="page-header">
    <h1>Parent & Student Management</h1>
    <dx-button text="Create Parent" type="success" (onClick)="openCreatePopup()" [icon]="'plus'"></dx-button>
  </div>

  <dx-data-grid
    [dataSource]="parents"
    [allowColumnReordering]="true"
    [allowColumnResizing]="true"
    [columnAutoWidth]="true"
    [showBorders]="true">
    <dxi-column caption="#" [cellTemplate]="'rowNumberTemplate'" [allowSorting]="false" [allowFiltering]="false" [width]="56"></dxi-column>
    <dxi-column dataField="firstName" caption="First Name"></dxi-column>
    <dxi-column dataField="lastName" caption="Last Name"></dxi-column>
    <dxi-column dataField="email" caption="Email"></dxi-column>
    <dxi-column dataField="phoneNumber" caption="Phone"></dxi-column>
    <dxi-column dataField="studentCount" caption="Students" dataType="number"></dxi-column>
    <dxi-column dataField="createdAt" caption="Created" dataType="date" format="shortDate"></dxi-column>
    <dxi-column dataField="isActive" caption="Active" dataType="boolean"></dxi-column>
    <div *dxTemplate="let data of 'rowNumberTemplate'">{{ (data.rowIndex ?? data.displayIndex ?? 0) + 1 }}</div>
  </dx-data-grid>

  <dx-popup
    [(visible)]="showCreatePopup"
    [showTitle]="true"
    title="Create Parent"
    [width]="500"
    [showCloseButton]="true"
    (onHiding)="closeCreatePopup()">
    <div *dxTemplate="let data of 'content'">
      <form [formGroup]="createForm" (ngSubmit)="onSubmitCreate()" class="form-panel">
        <div class="form-group"><label>Email *</label><input type="email" formControlName="email" class="form-control" /></div>
        <div class="form-group"><label>First Name *</label><input type="text" formControlName="firstName" class="form-control" /></div>
        <div class="form-group"><label>Last Name *</label><input type="text" formControlName="lastName" class="form-control" /></div>
        <div class="form-group"><label>Phone *</label><input type="text" formControlName="phoneNumber" class="form-control" /></div>
        <div class="form-actions">
          <dx-button text="Cancel" type="normal" (onClick)="closeCreatePopup()"></dx-button>
          <dx-button text="Create" type="success" (onClick)="onSubmitCreate()" [disabled]="!createForm.valid"></dx-button>
        </div>
      </form>
    </div>
  </dx-popup>
</div>
